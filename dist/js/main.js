!function(){var r,l,h,i,d,t,o,s,u,e=window.innerWidth,a=window.innerHeight,c=new Phaser.Game(2*e,2*a,Phaser.AUTO,"phaser"),g=!1,n={},p=[],m=[],y=[],f=!1,x=0,w=0,v=(g=!1,!1),_=[],E=[],L=[],C=0,I=800,P={getRandom:function(t,e){return Math.floor(Math.random()*(e-t)+t)},createRandomArr:function(t,e,a){for(var n=[],i=0;i<t;i++)n.push(P.getRandom(a,e));return n},getRandomPool:function(t){for(var e=[],a=0;a<t;a++){var n=Math.floor(10*Math.random()+0);n<3?e.push(1):n<7?e.push(0):n<9?e.push(2):e.push(3)}return e},getPathName:function(){for(var t=window.location.pathname.split("/"),e=[],a=0;a<t.length;a++)t[a]&&-1==t[a].indexOf("html")&&e.push(t[a]);return 0<e.length?"/"+e.join("/"):""}};function B(t){_=_.concat(P.createRandomArr(t,2,0)),E=E.concat(P.getRandomPool(t,3)),L=L.concat(P.createRandomArr(t,6,1))}function R(t){if(v)return!1;g||(g=!0,T(x));var e=(new Date).getTime();if(e-C<100)return!1;C=e,!1,d.animations.stop("walk",20,!1),d.animations.play("stand",30,!1),d.animations.play("jump",30,!1),x++,u=t.changedTouches[0].clientX>c.world.centerX/2?1:-1;var a,n,i={x:u*p[0].width/2,y:-(p[0].height-26)};o+=i.x,s+=i.y,c.add.tween(d).to({x:o,y:s},220,Phaser.Easing.Linear.None).start(),d.scale.x=-u,T(x),c.add.tween(r).to({x:r.x-i.x,y:r.y-i.y},250,Phaser.Easing.Linear.None).start(),f=!0,J(u)?(w++,document.querySelector(".score").innerHTML=w):v=!0,x%10==0&&(a=10,n=_.length,B(a),M(_,n),j(_,E,n)),setTimeout(function(){f=!1},250)}function T(a){setTimeout(function(){x==a&&N();var t=p[a];c.add.tween(t).to({x:t.x,y:t.y+c.height},I,Phaser.Easing.Quadratic.In).start();for(var e=0;e<m.length;e++)m[e]&&m[e].y==t.y&&(c.add.tween(m[e]).to({x:m[e].x,y:m[e].y+c.height},I,Phaser.Easing.Quadratic.In).start(),c.add.tween(y[e]).to({x:y[e].x,y:y[e].y+c.height},I,Phaser.Easing.Quadratic.In).start())},500)}function N(){c.add.tween(d).to({x:d.x,y:d.y+c.height},I,Phaser.Easing.Quadratic.In).start(),v=!0,document.getElementById("J_restarLayer").className="jumping_alert in"}function J(t){return p[x].direction==t}function M(t,e){e||(e=0);for(var a=e;a<t.length;a++){var n,i=t[a]?1:-1;n={x:p[a].x+i*(p[a].width/2),y:p[a].y-(p[a].height-26)};var r=c.add.sprite(n.x,n.y,"spritestairs","stone.png");r.direction=i,stonesGroup.addChild(r),p.push(r)}}function j(t,e,a){a||(a=0);for(var n=a;n<t.length;n++)if(e[n]){var i=-(t[n]?1:-1),r={x:0,y:0},d=p[n];r.x=d.x+i*(d.width/2)*e[n],r.y=d.y-(d.height-26)*e[n];var o=c.add.sprite(r.x,r.y,"spritestairs","stone.png");l.addChild(o),m.push(o);var s=c.add.sprite(r.x,r.y-d.height/2,"spritestairs","flag"+L[n]+".png");h.addChild(s),y.push(s)}else m.push(null),y.push(null)}n.load={preload:function(){c.scale.pageAlignHorizontally=!0,c.scale.pageAlignVertically=!0,c.scale.scaleMode=Phaser.ScaleManager.SHOW_ALL;var t=P.getPathName();c.load.image("leafLeft",t+"/dist/images/leaf_left.png"),c.load.image("leafRight",t+"/dist/images/leaf_right.png"),c.load.atlas("spritestairs",t+"/dist/images/spritestairs.png",t+"/dist/images/spritestairs.json"),c.load.spritesheet("robot",t+"/dist/images/spriterobot.png",150,294,17),c.load.onFileComplete.add(function(t){document.querySelector(".curr_process").style.width=t+"%",100==t&&(setTimeout(function(){document.getElementById("J_loadLayer").style.display="none",document.getElementById("J_Layer").style.display="block",document.getElementById("J_startLayer").className="jumping_alert in"},500),c.state.start("play"))}),B(20)}},n.play={create:function(){(function(){stonesGroup=c.add.group(),l=c.add.group(),h=c.add.group(),(r=c.add.group()).addChild(stonesGroup),r.addChild(l),r.addChild(h);var t=c.add.sprite(0,0,"spritestairs","stone.png");t.x=c.world.centerX-t.width/2,t.y=c.height/2+t.height,stonesGroup.addChild(t),p.push(t)})(),M(_),j(_,E),function(){(d=c.add.sprite(0,0,"robot",1)).anchor.set(.5),o=d.x=c.world.centerX,s=d.y=p[0].y-75,d.scale.x=-function(t){var e=p[x];if("curr"==t)return e.direction;if(p.length>=x+1){var a=p[x+1].direction;return a}return 1}(),d.animations.add("walk",[0,1,2,3,4,5,6,7,8,9],60,!0),d.animations.add("stand",[16],60,!0),t=d.animations.add("jump",[10,11,12,13,14,15,16],60,!0),c.input.touch.onTouchStart=R,t.onComplete.add(function(){d.animations.play("walk",30,!0),!0,J(u)||N()},this),r.addChild(d)}(),function(){i=c.add.group();var t=c.add.image(0,0,"leafLeft"),e=c.add.image(0,-t.height,"leafLeft"),a=c.add.image(0,0,"leafRight"),n=c.add.image(0,-t.height,"leafRight");a.x=n.x=c.width-Math.ceil(a.width),i.y=-e.height+c.height,i.addChild(t),i.addChild(a),i.addChild(e),i.addChild(n),i.z=100}()},update:function(){var t;t=6,f&&(i.y+=t,i.y>c.height&&(i.y=-(i.children[0].height-c.height))),h.sort("y",Phaser.Group.SORT_ASCENDING)}},c.state.add("load",n.load),c.state.add("play",n.play),c.state.start("load"),document.getElementById("J_startBtn").onclick=function(){document.getElementById("J_startLayer").className="jumping_alert out",setTimeout(function(){document.getElementById("J_Layer").style.display="none"},500)},document.getElementById("J_restartBtn").onclick=function(){B(),p=[],m=[],v=g=!(y=[]),w=x=0,document.querySelector(".score").innerHTML=0,document.getElementById("J_restarLayer").className="jumping_alert out",c.state.start("play")}}();